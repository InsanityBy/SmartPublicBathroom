/**
 ******************************************************************************
 * @file    main.c
 * @author  Ma Boyang
 * @version V1.0
 * @date    2022.5.9
 * @brief   Main program body.(For shower host.)
 ******************************************************************************
 */

/* Includes ------------------------------------------------------------------*/
#include "main.h"
#include <stdio.h>

/* Private typedef -----------------------------------------------------------*/
/* Private define ------------------------------------------------------------*/
/* Private macro -------------------------------------------------------------*/
/* Private variables ---------------------------------------------------------*/
uint8_t BMP1[]={
0x00,0x06,0x0A,0xFE,0x0A,0xC6,0x00,0xE0,0x00,0xF0,0x00,0xF8,0x00,0x00,0x00,0x00,
0x00,0x00,0xFE,0x7D,0xBB,0xC7,0xEF,0xEF,0xEF,0xEF,0xEF,0xEF,0xEF,0xC7,0xBB,0x7D,
0xFE,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x08,
0x0C,0xFE,0xFE,0x0C,0x08,0x20,0x60,0xFE,0xFE,0x60,0x20,0x00,0x00,0x00,0x78,0x48,
0xFE,0x82,0xBA,0xBA,0x82,0xBA,0xBA,0x82,0xBA,0xBA,0x82,0xBA,0xBA,0x82,0xFE,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x11,0xF1,
0xF8,0x18,0x18,0x18,0x18,0x18,0x18,0x18,0x18,0x18,0xF8,0xF8,0x00,0x00,0xF0,0xF8,
0x18,0x18,0x18,0x18,0x18,0x18,0x18,0x18,0x18,0xF8,0xF0,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0xF0,0xF8,0x18,0x18,0x18,0x18,0x18,0x18,0x18,0x18,
0x18,0xF8,0xF0,0x00,0x00,0xF0,0xF8,0x18,0x18,0x18,0x18,0x18,0x18,0x18,0x18,0x18,
0xF8,0xF0,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x48,0x48,0x5C,0x48,0xC8,0x48,0x5C,0x48,0x48,0x00,0x00,0x00,0xF0,
0x94,0x98,0x90,0xF0,0x90,0x98,0x94,0xF0,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFF,
0xFF,0x01,0x00,0x00,0x20,0x00,0x00,0x00,0x00,0x00,0xFF,0xFF,0x00,0x00,0xFF,0xFF,
0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0xFF,0xFF,0x00,0x00,0x00,0x00,0x0E,
0x0E,0x0E,0x00,0x00,0x00,0x00,0xFF,0xFF,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0xFF,0xFF,0x00,0x00,0xFF,0xFF,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,
0xFF,0xFF,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xF8,0x04,0x02,0x02,
0x02,0x02,0x04,0xF8,0x00,0x00,0xF8,0x04,0x02,0x02,0x02,0x02,0x04,0xF8,0x00,0x00,
0x00,0x00,0x00,0x24,0x15,0x0E,0x04,0xFF,0x04,0x0E,0x15,0x24,0x00,0x00,0x00,0x17,
0x14,0x14,0x14,0xFF,0x14,0x14,0x14,0x17,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x7F,
0xFF,0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,0xC2,0xC0,0xD8,0xFF,0x7F,0x00,0x00,0x7F,0xFF,
0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,0xFF,0x7F,0x00,0x00,0x00,0x00,0x07,
0x07,0x07,0x00,0x00,0x00,0x00,0x7F,0xFF,0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,
0xC0,0xFF,0x7F,0x00,0x00,0x7F,0xFF,0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,
0xFF,0x7F,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x03,0x04,0x08,0x08,
0x08,0x0A,0x04,0x0B,0x10,0x00,0x03,0x04,0x08,0x08,0x08,0x0A,0x04,0x0B,0x10,0x00,/*"D:\PKU\SmartPublicBathroom\Project\2_ShowerHost\Hardware\Reference\LCD\DEMO\桌面12832.bmp",0*/
};
/* Private function prototypes -----------------------------------------------*/
/* Private functions ---------------------------------------------------------*/
void USART_TestInit(void)
{
    // GPIO Config
    RCC_AHB1PeriphClockCmd(RCC_AHB1Periph_GPIOB, ENABLE); // GPIO Clock
    GPIO_InitTypeDef GPIO_USART;                          // GPIO Init Structure
    // USART1 TX - PB6
    GPIO_PinAFConfig(GPIOB, GPIO_PinSource6, GPIO_AF_USART1);
    GPIO_USART.GPIO_Pin = GPIO_Pin_6;
    GPIO_USART.GPIO_Mode = GPIO_Mode_AF;
    GPIO_USART.GPIO_OType = GPIO_OType_PP;
    GPIO_USART.GPIO_PuPd = GPIO_PuPd_UP;
    GPIO_USART.GPIO_Speed = GPIO_Speed_50MHz;
    GPIO_Init(GPIOB, &GPIO_USART);

    // USART6 RX - PA12
    GPIO_PinAFConfig(GPIOA, GPIO_PinSource12, GPIO_AF_USART6);
    GPIO_USART.GPIO_Pin = GPIO_Pin_12;
    GPIO_USART.GPIO_Mode = GPIO_Mode_AF;
    GPIO_Init(GPIOA, &GPIO_USART);

    // USART1 Config
    RCC_APB2PeriphClockCmd(RCC_APB2Periph_USART1, ENABLE); // USART Clock
    USART_InitTypeDef USART_InitStructure;                 // USART Init Structure
    USART_InitStructure.USART_BaudRate = 115200;
    USART_InitStructure.USART_WordLength = USART_WordLength_8b;
    USART_InitStructure.USART_StopBits = USART_StopBits_1;
    USART_InitStructure.USART_Parity = USART_Parity_No;
    USART_InitStructure.USART_HardwareFlowControl = USART_HardwareFlowControl_None;
    USART_InitStructure.USART_Mode = USART_Mode_Rx | USART_Mode_Tx;
    USART_Init(USART1, &USART_InitStructure);
    USART_Cmd(USART1, ENABLE);
}

void USART_TestSendData(uint8_t Data)
{
    while (USART_GetFlagStatus(USART1, USART_FLAG_TXE) == RESET)
        ;
    USART_SendData(USART1, Data);
}

int fputc(int ch, FILE *f)
{
    USART_TestSendData((uint8_t)ch);
    return (ch);
}

/**
 * @brief  Main program
 * @param  None
 * @retval None
 */
int main(void)
{
    /* Initialize all peripherals*/
    // char Receive_Buffer[256] = "AT+ZIGB_TYPE=0\r\n";
    // char Transmit_Buffer[] = "Temperature: 12";
    // char Receive_Buffer[256];
    Delay_us(1000);
    NVIC_PriorityGroupConfig(NVIC_PriorityGroup_2);
    // USART_TestInit();
    // SignalOutput_Init();
    // Button_Init();
    // TemperatureHumiditySensor_Init();
    // LightSensor_Init();
    // ZigBee_Init(Transmit_Buffer, Receive_Buffer);
    //  WiFi_Init(Transmit_Buffer, Receive_Buffer);
    // Audio_Init();
    // Audio_Volume(15);
    Display_Init();
    Delay_ms(1);
    // printf("Initialize finished!\n");
    // uint16_t temp = sizeof(Transmit_Buffer) / sizeof(Transmit_Buffer[0]) - 1;
    // WiFi_TransmitString(temp, 100);
    // ZigBee_TransmitString(temp, 100);

    /* Infinite loop */
    while (1)
    {
        // Display_LightUp();
        Delay_ms(2000);
        // Display_Clear();
        // Audio_Play(0x0005);
        //  Sensor_Convert();
        //  printf("Temperature: %f\n", Sensor_GetTemperature());
        //  printf("Humidity: %f\n", Sensor_GetHumidity());
        //  printf("LightState: %d\n", LightSensor_GetState());
        //  printf("LightValue: %f\n", LightSensor_GetValue());
        // ZigBee_ReceiveString(100);
        // uint16_t length = WiFi_ReceiveString(100);
        // Display_ShowString(0, 0, Transmit_Buffer, FONTSIZE_8);
        Display_DrawBMP(0, 0, 127, 3, BMP1);
    }
}

/***********************************END OF FILE********************************/
